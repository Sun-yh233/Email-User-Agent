# 邮件用户代理详细使用手册

## 目录
1. [简介](#简介)
2. [系统要求](#系统要求)
3. [安装与配置](#安装与配置)
4. [功能说明](#功能说明)
5. [常见问题](#常见问题)
6. [技术细节](#技术细节)

## 简介

邮件用户代理是一个基于Python开发的跨平台邮件客户端，支持SMTP协议发送邮件和POP3协议接收邮件。本程序完全使用Python标准库实现，无需安装额外的第三方依赖包（除了用于打包的PyInstaller）。

### 主要特性

- **邮件发送**: 支持SMTP协议，可发送文本邮件和附件
- **邮件接收**: 支持POP3协议，可接收和查看邮件
- **多账号管理**: 支持添加和管理多个邮箱账号
- **跨平台**: 支持Windows和Linux操作系统
- **图形界面**: 使用tkinter实现友好的用户界面
- **安全通信**: 支持SSL/TLS加密连接
- **扩展接口**: 为未来的Base64编码定制预留接口

## 系统要求

- **Python版本**: Python 3.6或更高版本
- **操作系统**: Windows 7/10/11 或 Linux (Ubuntu, CentOS, Debian等)
- **GUI支持**: tkinter (通常已包含在Python标准发行版中)

### 检查系统环境

在Linux系统上，确保安装了tkinter:

```bash
# Ubuntu/Debian
sudo apt-get install python3-tk

# CentOS/RHEL
sudo yum install python3-tkinter

# Fedora
sudo dnf install python3-tkinter
```

## 安装与配置

### 方式一: 从源代码运行

1. **克隆仓库**
```bash
git clone https://github.com/Sun-yh233/Email-User-Agent.git
cd Email-User-Agent
```

2. **安装依赖** (可选，仅用于构建)
```bash
pip install -r requirements.txt
```

3. **运行程序**
```bash
python main.py
```

### 方式二: 使用可执行文件

1. 下载对应平台的可执行文件
2. Windows: 双击 `EmailClient-Windows.exe` 运行
3. Linux: 在终端运行 `./EmailClient-Linux`

### 首次使用配置

1. 启动程序后，点击菜单栏的"设置" -> "账号管理"
2. 点击"添加"按钮添加新账号
3. 填写账号信息（详见下文）
4. 点击"保存"按钮

## 功能说明

### 1. 账号管理

#### 添加账号

1. 点击"设置" -> "账号管理"
2. 在右侧表单中填写以下信息:
   - **账号名称**: 给账号起一个便于识别的名字
   - **邮箱地址**: 您的完整邮箱地址
   - **SMTP服务器**: 发送邮件服务器地址
   - **SMTP端口**: 通常为465 (SSL)或587 (TLS)
   - **POP3服务器**: 接收邮件服务器地址
   - **POP3端口**: 通常为995 (SSL)或110
   - **密码/授权码**: 邮箱密码或应用专用密码
   - **使用SSL/TLS**: 建议勾选，提供加密保护

3. 点击"自动识别服务器"按钮可自动填充常见邮箱的服务器配置
4. 点击"保存"按钮完成添加

#### 常见邮箱服务器配置

##### QQ邮箱
- **邮箱地址**: your_email@qq.com
- **SMTP服务器**: smtp.qq.com
- **SMTP端口**: 465
- **POP3服务器**: pop.qq.com
- **POP3端口**: 995
- **密码**: 使用QQ邮箱的授权码（不是QQ密码）
- **获取授权码**: 登录QQ邮箱 -> 设置 -> 账户 -> POP3/SMTP服务 -> 生成授权码

##### 163邮箱
- **邮箱地址**: your_email@163.com
- **SMTP服务器**: smtp.163.com
- **SMTP端口**: 465
- **POP3服务器**: pop.163.com
- **POP3端口**: 995
- **密码**: 使用163邮箱的授权码
- **获取授权码**: 登录163邮箱 -> 设置 -> POP3/SMTP/IMAP -> 开启服务并设置客户端授权码

##### 126邮箱
- **邮箱地址**: your_email@126.com
- **SMTP服务器**: smtp.126.com
- **SMTP端口**: 465
- **POP3服务器**: pop.126.com
- **POP3端口**: 995

##### Sina邮箱
- **邮箱地址**: your_email@sina.com
- **SMTP服务器**: smtp.sina.com
- **SMTP端口**: 465
- **POP3服务器**: pop.sina.com
- **POP3端口**: 995

##### Gmail
- **邮箱地址**: your_email@gmail.com
- **SMTP服务器**: smtp.gmail.com
- **SMTP端口**: 465
- **POP3服务器**: pop.gmail.com
- **POP3端口**: 995
- **密码**: 使用应用专用密码
- **注意**: 需要在Google账号中启用"不够安全的应用访问"或使用应用专用密码

### 2. 发送邮件

1. 切换到"发送邮件"标签页
2. 填写邮件信息:
   - **收件人**: 输入收件人邮箱地址，多个收件人用逗号分隔
   - **抄送**: (可选) 输入抄送人邮箱地址
   - **主题**: 输入邮件主题
   - **正文**: 输入邮件正文内容

3. 点击"发送"按钮发送邮件
4. 等待发送完成，系统会显示发送结果

### 3. 接收邮件

1. 切换到"接收邮件"标签页
2. 点击"接收邮件"按钮
3. 等待接收完成，邮件列表会显示收到的邮件
4. 点击邮件列表中的任意邮件，下方会显示该邮件的详细内容:
   - 发件人
   - 收件人
   - 主题
   - 日期
   - 邮件正文

### 4. 高级设置

#### 自定义Base64编码（安全通信）

本功能为未来的邮件安全通信预留，支持使用自定义Base64编码表对邮件正文进行编码。

1. 点击"设置" -> "高级设置"
2. 勾选"启用自定义Base64编码"
3. 输入共享密钥（通信双方必须使用相同的密钥）
4. 点击"保存"

**注意事项**:
- 启用后，发送的邮件正文会使用自定义编码
- 接收方也必须启用相同的共享密钥才能正确解码
- 此功能适用于与其他使用本程序的用户进行安全通信

#### 其他设置

- **每次接收最大邮件数**: 设置每次点击"接收邮件"按钮时最多获取多少封邮件（默认50封）

## 常见问题

### Q1: 无法连接到邮件服务器

**可能原因**:
1. 服务器地址或端口配置错误
2. 网络连接问题
3. 防火墙阻止连接

**解决方法**:
1. 检查服务器配置是否正确
2. 尝试使用浏览器访问邮箱网页版，确认网络正常
3. 检查防火墙设置
4. 尝试关闭SSL选项（不推荐，仅用于测试）

### Q2: 认证失败

**可能原因**:
1. 密码或授权码错误
2. 未开启SMTP/POP3服务
3. 需要使用授权码而不是密码

**解决方法**:
1. 检查密码是否正确
2. 在邮箱设置中开启SMTP和POP3服务
3. 使用邮箱提供的授权码或应用专用密码

### Q3: 发送邮件失败

**可能原因**:
1. 收件人地址格式错误
2. 邮件内容被判定为垃圾邮件
3. 超出发送频率限制

**解决方法**:
1. 检查收件人地址格式
2. 避免在邮件中包含大量链接或敏感词汇
3. 降低发送频率

### Q4: 无法接收邮件

**可能原因**:
1. POP3服务未开启
2. 邮箱中没有邮件
3. 邮件已被其他客户端下载并删除

**解决方法**:
1. 在邮箱设置中开启POP3服务
2. 使用网页版确认是否有邮件
3. 设置POP3为"保留邮件副本"模式

### Q5: 中文乱码

**可能原因**:
1. 编码设置不当
2. 邮件使用了特殊编码

**解决方法**:
- 本程序使用UTF-8编码处理邮件，如遇到乱码请联系开发者

### Q6: Linux上无法启动GUI

**可能原因**:
- 未安装tkinter

**解决方法**:
```bash
# Ubuntu/Debian
sudo apt-get install python3-tk

# CentOS/RHEL
sudo yum install python3-tkinter
```

## 技术细节

### 协议实现

#### SMTP协议
- 使用Python标准库 `smtplib`
- 支持SMTP AUTH认证
- 支持SSL/TLS加密
- 遵循RFC 5321规范

#### POP3协议
- 使用Python标准库 `poplib`
- 支持基本认证
- 支持SSL加密
- 遵循RFC 1939规范

### 编码处理

- 邮件头部: 自动处理各种编码（UTF-8, GB2312等）
- 邮件正文: UTF-8编码
- Base64编码: 可选的自定义编码表支持

### 安全性

- 支持SSL/TLS加密连接
- 密码在配置文件中以明文存储（注意保护config.json文件）
- 建议使用授权码而不是账号密码
- 自定义Base64编码提供基本的内容混淆

### 兼容性

- **操作系统**: Windows 7+, Linux (主流发行版)
- **Python版本**: 3.6+
- **邮件服务器**: 支持标准SMTP和POP3协议的所有服务器
- **客户端互操作**: 与其他标准邮件客户端完全兼容

### 文件结构

```
Email-User-Agent/
├── main.py              # 主程序入口
├── smtp_client.py       # SMTP客户端实现
├── pop3_client.py       # POP3客户端实现
├── email_encoder.py     # Base64编码器
├── config_manager.py    # 配置管理
├── gui.py              # GUI界面
├── config.json         # 配置文件（自动生成）
├── requirements.txt    # 依赖列表
├── README.md          # 项目说明
├── MANUAL.md          # 本手册
└── docs/
    └── REPORT.md      # 项目报告
```

### 配置文件格式

`config.json` 文件格式:

```json
{
  "accounts": [
    {
      "name": "我的QQ邮箱",
      "email": "example@qq.com",
      "smtp_server": "smtp.qq.com",
      "smtp_port": 465,
      "pop3_server": "pop.qq.com",
      "pop3_port": 995,
      "password": "授权码",
      "use_ssl": true
    }
  ],
  "current_account": "我的QQ邮箱",
  "settings": {
    "auto_receive": false,
    "receive_interval": 300,
    "max_emails": 50,
    "use_custom_encoder": false,
    "shared_secret": ""
  }
}
```

## 未来扩展

### Base64编码定制

程序已预留接口支持以下功能:

1. **自定义编码表**: 可以使用自定义的64字符集作为Base64编码表
2. **编码表协商**: 通信双方可基于共享密钥自动生成相同的编码表
3. **一次一变机制**: 支持每次通信使用不同的编码表

使用方法参见[高级设置](#自定义base64编码安全通信)部分。

### 扩展建议

如需扩展程序功能，可以:

1. 在 `smtp_client.py` 中扩展SMTP功能
2. 在 `pop3_client.py` 中扩展POP3功能
3. 在 `email_encoder.py` 中实现更复杂的编码算法
4. 在 `gui.py` 中添加新的界面功能

## 技术支持

- **项目主页**: https://github.com/Sun-yh233/Email-User-Agent
- **问题反馈**: 在GitHub上提交Issue
- **参与开发**: 欢迎提交Pull Request

## 许可证

MIT License - 详见LICENSE文件

---

**版本**: 1.0  
**更新日期**: 2025-12-28  
**作者**: Sun-yh233
